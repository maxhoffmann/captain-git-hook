#!/usr/bin/env node
"use strict";
var path = require('path');
var execSync = require('child_process').execSync;
var hook = path.basename(__filename);
var config = require(path.resolve(process.cwd(), 'package'));

if (!config[hook]) {
  process.exit(0);
}

var output = [];
var error = false;
var errorStatus = '';

config[hook].forEach(function (command) {
  var cmd = config.scripts[command];

  try {
    output.push(execSync(cmd, { encoding: 'utf-8' }));
  } catch (e) {
    console.log(e.stdout);
    console.error(e.stderr);
    error = true;
    errorStatus = e.status;
  }
});

if (error) {
  process.exit(errorStatus);
} else {
  output.forEach(function(message) {
    if (message) {
      console.log(message);
    }
  });
}
